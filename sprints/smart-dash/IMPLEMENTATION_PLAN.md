# Implementation Plan (rendered from state)

Generated: 2026-02-16T17:52:07.820695


## Foundation

- [ ] **1.1**: Create the single-file HTML dashboard with complete document structure, dark-theme CSS, and single-column responsive layout optimized for 400px side-pane width. Include semantic HTML sections (header, four widget containers in visual hierarchy order: clock, weather, tasks, timer), CSS custom properties for the dark color scheme (#1a1a2e background, light text, accent colors), and responsive styles that work from 400px to full width. The file must be at sprints/smart-dash/index.html.
  - Value: Provides the visual foundation the developer will see every day — a clean, dark-themed, narrow-pane layout that reduces eye strain and fits beside their editor without competing for attention
  - Acceptance: index.html exists at sprints/smart-dash/index.html, opens in a browser showing a dark-themed page with four clearly labeled empty widget sections in single-column layout, no horizontal scrollbar at 400px viewport width, no console errors


## Core

- [ ] **2.1**: Implement the Clock Widget inside the clock container in index.html. Display current time in HH:MM:SS 24-hour format and date as Day, Month DD (e.g. Sunday, February 16). Use setInterval at 1-second updates. The clock must be visible immediately on page load with no user interaction required.
  - Value: Gives the developer an always-visible time reference so they never need to glance at the system clock or switch tabs to check the time during focus sessions
  - Acceptance: Opening index.html shows the current time updating every second in HH:MM:SS 24h format, and the current date in Day, Month DD format. Time matches system clock within 1 second.
  - Deps: 1.1

- [ ] **2.2**: Implement the Weather Widget inside the weather container in index.html. Define a JS constant for the city name (default: London) and a placeholder API key constant (empty string) at the top of the script. On page load, if the API key is empty, immediately display fallback text: Weather unavailable (skip the fetch entirely). If the key is non-empty, attempt to fetch weather from OpenWeatherMap API (https://api.openweathermap.org/data/2.5/weather?q=CITY&units=metric&appid=KEY). Note the URL MUST include the https:// protocol prefix or fetch() will treat it as a relative URL and fail. If the request fails for any reason (network error, invalid key, non-200 response), display fallback text: Weather unavailable. If successful, show temperature in degrees C and condition text (e.g. 15 degrees C, Cloudy). Include a comment with the URL to obtain a free API key (https://home.openweathermap.org/users/sign_up). Set a 30-minute refresh interval using setInterval. No console errors should be thrown on failure — catch all fetch errors gracefully.
  - Value: Shows the developer current weather at a glance so they can plan breaks (go outside in nice weather) without leaving their focus view, with graceful degradation when no API key is configured
  - Acceptance: With no API key configured: widget shows Weather unavailable without any console errors. With a valid API key: widget shows temperature and conditions for the configured city. The city constant and API key constant are clearly labeled at the top of the script with instructional comments.
  - Deps: 1.1

- [ ] **2.3**: Implement the Task List Widget inside the tasks container in index.html. Features: (1) Text input field where pressing Enter adds a new task. (2) Each task renders with a checkbox to toggle complete (applies strikethrough style) and an x button to delete. (3) A task count summary showing total tasks and completed count (e.g. 3 tasks, 1 done). (4) All task state persists to localStorage on every change (add, complete, delete). (5) Tasks load from localStorage on page load, restoring previous state including completion status. Use a JSON array in localStorage with objects containing text and completed boolean.
  - Value: Enables the developer to maintain a simple, persistent task list right beside their editor — no more forgetting what to do next or losing lists when the browser closes
  - Acceptance: Can add a task by typing text and pressing Enter. Task appears in the list. Checking the checkbox applies strikethrough. Clicking x removes the task. Task count updates accurately after each operation. Refreshing the page restores all tasks with their completion state. localStorage contains the task data as a JSON array.
  - Deps: 1.1

- [ ] **2.4**: Implement the Pomodoro Timer Widget inside the timer container in index.html. Features: (1) MM:SS countdown display starting at 25:00 for work mode. (2) Three buttons labeled Start, Pause, and Reset. Start begins or resumes the countdown, Pause stops it at the current time, Reset returns the display to the current mode default time (25:00 for WORK, 5:00 for BREAK) and stops the countdown. (3) A mode label showing WORK or BREAK. (4) CRITICAL: Web Audio API setup — create the AudioContext during the Start button click handler (this user gesture satisfies the browser autoplay policy). Store the AudioContext reference globally so it is available when the timer reaches 00:00. If audioContext.state is suspended, call audioContext.resume() inside the Start click handler. When the timer reaches 00:00, use the existing AudioContext to create an OscillatorNode at 440Hz, connect it to destination, play for 0.3 seconds, then stop. Do NOT create a new AudioContext at timer expiry — it may be auto-suspended by Chrome if no recent user gesture. (5) When timer reaches 00:00: play the beep as described, increment the completed pomodoro count if the finishing mode was WORK, switch the mode (WORK to BREAK or BREAK to WORK), set the display to the new mode default time, and automatically start the countdown for the new mode without requiring the user to click Start again. (6) Display a completed pomodoro count (integer, starts at 0 on page load, not persisted across reloads). (7) Use setInterval with 1-second ticks for the countdown.
  - Value: Keeps the developer on a healthy work-break cadence with an always-visible timer and unmissable audio notification — no more losing track of time during deep focus sessions
  - Acceptance: Clicking Start begins countdown from 25:00. Display updates every second. Clicking Pause stops the countdown. Clicking Reset returns to current mode time. When timer reaches 00:00, an audible beep plays. Mode auto-switches from WORK to BREAK (5:00) and back. WORK/BREAK label updates accordingly. Completed pomodoro count increments after each WORK period. All buttons are functional and clearly labeled.
  - Deps: 1.1


## Integration

- [ ] **3.1**: Review the complete index.html for integration correctness and file size compliance. Verify: (1) All four widgets coexist without JS conflicts (no duplicate variable names, no shared global state collisions). (2) Multiple setInterval calls (clock 1s, timer 1s, weather 30min) do not interfere with each other. (3) localStorage operations in the task widget do not conflict with any other widget state. (4) Total file size is under 15KB as required by the PRD. If over 15KB, minify CSS/JS inline (remove unnecessary whitespace, shorten variable names) while keeping the code readable. (5) No console errors on page load when served via static server. (6) Dark theme is visually consistent across all four widgets. Fix any issues found.
  - Value: Ensures the developer gets a polished, error-free single-file dashboard where all four widgets work harmoniously — the consolidation promise only works if everything functions together without glitches
  - Acceptance: File size of index.html is under 15KB (verify with file size check). Opening the page via http://localhost:8000/index.html shows all four widgets rendering correctly. Browser console shows no errors (weather fallback text is acceptable, not an error). All widgets function simultaneously without interfering with each other.
  - Deps: 2.1, 2.2, 2.3, 2.4


## Verification

- [ ] **4.1**: Write Playwright end-to-end tests in sprints/smart-dash/tests/test_dashboard.py that verify all value proofs. Tests run against http://localhost:8000/index.html using pytest-playwright. The conftest.py MUST start a Python HTTP server (python -m http.server 8000) serving from sprints/smart-dash/ as a pytest fixture (session-scoped) and tear it down after tests complete, so tests are self-contained and do not require a manually started server. Test cases: (1) test_all_widgets_visible: page loads and all four widget containers are visible with expected content (clock shows time, weather shows text, task input exists, timer shows 25:00). (2) test_clock_updates: clock time text changes within 2 seconds of observation. (3) test_task_crud_and_persistence: add a task, verify it appears with correct count, mark complete, verify strikethrough style, delete, verify removal, then reload page and verify remaining tasks persist. (4) test_pomodoro_controls: click Start, verify timer value decreases, click Pause, verify it stops, click Reset, verify it returns to 25:00. (5) test_layout_400px: set viewport to 400px width and verify no horizontal scrollbar (page scrollWidth <= 400). (6) test_no_console_errors: collect console errors during page load and basic interactions, assert none (weather fallback messages are not errors). (7) test_task_count_display: add multiple tasks, complete some, verify count text accuracy.
  - Value: Provides automated proof that the dashboard delivers on every promise in the Vision — these tests can be re-run after any change to guarantee nothing regresses
  - Acceptance: All tests pass when run with pytest sprints/smart-dash/tests/ against the static server. Tests cover: widget visibility, clock updating, task CRUD with persistence, pomodoro controls, 400px layout, console error absence, and task count accuracy. Tests use pytest-playwright and are in sprints/smart-dash/tests/.
  - Deps: 3.1
