# Value Checklist: time-tracker
Generated: 2026-02-17T14:29:08.391002

## VRC Status
- Value Score: 91%
- Verified: 10/11
- Blocked: 1
- Recommendation: CONTINUE
- Summary: Fallback VRC: 10/11 tasks done

## Tasks
- [x] **1.1**: Create project scaffolding: directory structure (backend/, frontend/, data/, tests/), .gitignore (excluding data/, *.db, __pycache__/), requirements.txt (fastapi, uvicorn), and the FastAPI application entry point (backend/main.py) with configurable port via PORT env var and --port CLI flag. Mount static files from frontend/ directory. Include a minimal frontend/index.html placeholder to verify static serving works. IMPORTANT: Port 8000 is occupied on this system. The app MUST support PORT env var and --port CLI arg. Dev server should default to a configurable port (suggest 8765 as fallback). Tests must NEVER use a fixed port — use socket to find a free port dynamically.
- [x] **1.2**: Implement the SQLite database layer (backend/database.py): connection management using sqlite3 stdlib with PRAGMA foreign_keys = ON enabled on every connection (SQLite does not enforce foreign keys by default). CREATE TABLE IF NOT EXISTS for projects table (id, name, client_name, hourly_rate, color, archived, created_at, updated_at) and time_entries table (id, project_id FK, description, start_time, end_time nullable, duration_seconds nullable, created_at, updated_at). Auto-migration runs on app startup. Use a configurable DB path (default: data/timetracker.db relative to sprint dir) so tests can use temp databases. Ensure the data/ directory is created automatically if missing.
- [x] **1.3**: Define all Pydantic request/response models (backend/models.py): ProjectCreate, ProjectResponse, ProjectUpdate for projects; EntryCreate (manual), EntryResponse for time entries; TimerStartRequest, TimerResponse for the timer; and error response model. All datetime fields use ISO 8601 format. EntryResponse includes computed fields project_name and project_color joined from projects table. TimerResponse includes elapsed_seconds computed from start_time vs now.
- [x] **1.4**: Implement Project API endpoints (backend/routes/projects.py) and register as FastAPI router: GET /api/projects (list all, with ?active=true filter for non-archived), POST /api/projects (create, returns 201), GET /api/projects/{id} (get one, 404 if missing), PUT /api/projects/{id} (update, partial fields accepted), DELETE /api/projects/{id} (only if no entries, 409 if has entries, 204 on success). All responses use Pydantic models. Proper error handling with JSON error responses.
- [x] **1.5**: Implement Timer API endpoints (backend/routes/entries.py — timer section): GET /api/timer (return running timer with elapsed_seconds computed from start_time vs now, or null if none), POST /api/timer/start (create time_entry with end_time=NULL, auto-stop any existing running timer first — auto-switch behavior, returns 201), POST /api/timer/stop (find running entry, set end_time=now, compute duration_seconds, return completed entry). Also implement basic Time Entries endpoints: GET /api/entries (with ?date=YYYY-MM-DD filter for today view, and ?from=&to= for date ranges), POST /api/entries (manual entry with start_time and end_time required), PUT /api/entries/{id}, DELETE /api/entries/{id} (204). All entry responses include project_name and project_color from joined project data.
- [x] **1.6**: Build the complete frontend SPA shell (frontend/index.html, frontend/style.css, frontend/app.js): Tab-based navigation with Timer (default), Weekly, Projects, Reports tabs. Full dark theme implementation per PRD 4.6 specs (backgrounds #0d1117/#161b22/#21262d, text #e6edf3/#8b949e, accent colors, borders #30363d). System font stack with specified sizes. Responsive layout: sidebar navigation at >=1024px desktop, top tabs at 768-1023px tablet. Loading states (spinner) and error toast notifications. The app.js should implement a router/state manager for tab switching and API communication layer using fetch() with proper error handling. Include the project color palette (#58a6ff, #3fb950, #f85149, #d29922, #bc8cff, #f778ba, #79c0ff, #56d364).
- [x] **1.7**: Implement the complete Timer View (dashboard/default view in app.js), combining the active timer and today's entries into one cohesive panel. Active timer section: project dropdown (fetched from GET /api/projects?active=true, showing color indicators), description text input, Start/Stop toggle button (green Start/#3fb950 when idle, red Stop/#f85149 when running). Real-time HH:MM:SS display updating every second via setInterval, computed from server start_time (not cumulative increments). On page load, check GET /api/timer — if a timer is running, show it with correct elapsed time. Start calls POST /api/timer/start, Stop calls POST /api/timer/stop. Timer display uses 32px monospace bold font. Poll timer status every 5 seconds for cross-tab accuracy. Today's entries section: Fetch GET /api/entries?date=<today> and render a chronological list (most recent first). Each entry shows: project color dot, project name, description, start-end times (HH:MM format), duration (HH:MM). Delete button on each entry (with confirmation dialog) calling DELETE /api/entries/{id}. Add Manual Entry button opens a form with: date (defaults today), start time, end time, project dropdown, description — submits to POST /api/entries. Today Summary: total hours today (HH:MM format) and breakdown by project (color dot + name + hours). Refresh entries list after any mutation (stop timer, add manual, delete).
- [x] **1.9**: Implement the Projects View frontend (app.js, PRD section 4.4): Project list as cards showing color swatch, name, client name, hourly rate. Active and Archived tabs to filter display (archived tab shows message that archive functionality is coming in a future update). New Project button opens a form/modal with: name (required), client name, hourly rate (number input), color picker (preset palette of 8 colors from PRD 4.6). Save calls POST /api/projects. This view provides the project management UI that complements the project dropdown in the timer. Scope for this epic: create + list + display only. Full edit/archive/delete UI is deferred to Epic 2.
- [x] **1.10**: Write comprehensive API tests (tests/conftest.py + tests/test_api_projects.py + tests/test_api_entries.py + tests/test_api_timer.py): conftest.py provides fixtures for a test database (tempfile, cleaned between tests) and httpx.AsyncClient using httpx.ASGITransport(app=app) for in-process testing (NO network port needed). Test coverage: Projects CRUD (create, list, get, update, list active filter, delete with/without entries, 404/409 errors). Timer (start, get running, stop, auto-switch when starting while one runs, stop when none running). Entries (create manual, list by date, list by date range, update, delete, entries include project_name and project_color). Error handling (missing fields return 400/422, not found returns 404).
- [B] **1.11**: Write Playwright frontend tests (tests/test_frontend_timer.py, tests/test_frontend_projects.py): conftest.py adds fixtures to start the FastAPI server on a dynamic port (find free port, start uvicorn in subprocess, wait for health, yield, shutdown) with a temp database. test_frontend_timer.py: navigate to app, create a project via API, select project in dropdown, click Start, verify timer display shows and counts, click Stop, verify entry appears in today list with correct project. test_frontend_projects.py: navigate to Projects tab, click New Project, fill form, submit, verify card appears in list. Tests use pytest-playwright page fixture pointed at the running server.
- [x] **VRC-1**: Implement Reports/Timesheet API endpoints (backend/routes/reports.py): GET /api/reports/timesheet with ?from=DATE&to=DATE and optional ?project_id= parameters, returning entries grouped by date with project details, daily subtotals, and grand totals including calculated amounts (hours x hourly_rate). GET /api/reports/timesheet/csv with same parameters, returning a downloadable CSV file with columns: date, project, client, description, hours, rate, amount. Register the reports router in main.py.

## Verifications