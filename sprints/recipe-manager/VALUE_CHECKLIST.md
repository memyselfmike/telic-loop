# Value Checklist: recipe-manager
Generated: 2026-02-17T23:32:35.455697

## VRC Status
- Value Score: 100%
- Verified: 9/9
- Blocked: 0
- Recommendation: SHIP_READY
- Summary: Epic 1 (Recipe Collection) remains at 100% value delivery. No changes since iteration 21. All 9 deliverables verified at EXISTS+WORKS+VALUE. Backend: FastAPI+SQLite with auto-schema, 5 seed recipes, full CRUD API with combinable search/category/tag filters including ingredient search. Frontend: dark-themed SPA, responsive cards, detail modal, create/edit form with dynamic ingredients. All 62 pytest tests passing. Full lifecycle confirmed. Database persists. No gaps, no regressions. Ship ready.

## Tasks
- [x] **E1-1**: Set up project structure with backend/main.py (FastAPI app with CORS, static file mounting for frontend/, configurable PORT via env var defaulting to 8000), backend/requirements.txt (fastapi, uvicorn), and frontend directory structure (index.html, css/style.css, js/app.js, js/recipes.js, js/planner.js, js/shopping.js). FastAPI serves frontend at / via StaticFiles mount and exposes API routes under /api/.
- [x] **E1-2**: Create backend/database.py with SQLite connection management: get_db() function returning a connection to data/recipes.db with foreign keys enabled (PRAGMA foreign_keys=ON), init_db() function that creates recipes table (id, title, description, category, prep_time_minutes, cook_time_minutes, servings, instructions, tags, created_at, updated_at) and ingredients table (id, recipe_id FK CASCADE, quantity, unit, item, grocery_section, sort_order). Data directory and .db file auto-created if missing. init_db() called on app startup. On first run when recipes table is empty, insert 5 seed recipes (one per category: breakfast, lunch, dinner, snack, dessert) each with 3-6 ingredients spanning different grocery_sections and units per PRD Section 2.3.
- [x] **E1-3**: Create backend/models.py with Pydantic v2 models for recipe API request/response: IngredientCreate (quantity: float, unit: str, item: str, grocery_section: str with default other), RecipeCreate (title, description, category, prep_time_minutes, cook_time_minutes, servings, instructions, tags, ingredients: list[IngredientCreate]), IngredientResponse (adds id, sort_order), RecipeResponse (adds id, created_at, updated_at, ingredients: list[IngredientResponse]), RecipeListItem (card-level fields: id, title, category, prep_time_minutes, cook_time_minutes, tags -- without full ingredients for efficient list endpoint).
- [x] **E1-4**: Create backend/routes/recipes.py with full Recipe CRUD endpoints and query filtering: POST /api/recipes (create recipe with nested ingredients, return 201), GET /api/recipes (list recipes with optional ?category= exact match, ?tag= partial match in comma-separated tags, ?search= across title, description, AND ingredient items via LEFT JOIN with SELECT DISTINCT; all three combinable with AND logic), GET /api/recipes/{id} (single recipe with full ingredients), PUT /api/recipes/{id} (update recipe, replace ingredients list entirely), DELETE /api/recipes/{id} (cascade removes ingredients). Wire router into main.py. All endpoints use proper HTTP status codes (201 create, 404 not found, 200 success).
- [x] **E1-5**: Write pytest integration tests in tests/test_api.py for all recipe API endpoints: test create recipe with ingredients (201, verify fields), test get recipe list (200, array), test get single recipe with ingredients (200, nested), test update recipe and replace ingredients (200, verify changes), test delete recipe (200, subsequent GET 404), test cascading delete removes ingredients. Test all filter combinations: category filter, tag filter, search by title, search by ingredient name (via JOIN), combined filters. Test seed data: fresh DB has 5 recipes spanning all 5 categories with ingredients. Use httpx.AsyncClient with FastAPI TestClient and a fresh temp DB per test session.
- [x] **E1-6**: Build the SPA shell and professional dark theme. Rewrite frontend/index.html with semantic HTML: top navigation bar with three tabs (Recipes, Meal Plan, Shopping List), main content area with id=app. Create frontend/css/style.css with professional dark theme: dark background (#1a1a2e or similar), light text (#eee), accent color for interactive elements, styled nav bar with active tab highlighting, card component styles, modal overlay styles, form input styles, button styles (primary/danger/ghost variants), responsive grid breakpoints for 1024px and 768px. Create frontend/js/app.js with: hash-based SPA router defaulting to #recipes, route change listener calling view-specific render functions, active tab state management, shared async API fetch wrapper with error handling, DOM helper utilities. Recipes tab active by default on load.
- [x] **E1-7**: Build the recipe collection view with card grid and filter bar in frontend/js/recipes.js. (1) Filter bar at top: search text input with debounced keyup (300ms), category dropdown (All/breakfast/lunch/dinner/snack/dessert), tag filter input. All three filters combine: changing any re-fetches GET /api/recipes with all current filter values as query params. (2) Card grid: responsive CSS grid of recipe cards, each showing title as heading, category badge (colored pill), total time (prep+cook as e.g. 35 min), tag chips. Cards clickable -- click opens recipe detail view (E1-8). (3) Add Recipe button in filter bar area opens create form modal (E1-9). On initial load of #recipes view, fetch GET /api/recipes with no filters to show all. 5 seed recipes must appear as cards immediately.
- [x] **E1-8**: Build the recipe detail view in frontend/js/recipes.js (extending it). When a recipe card is clicked, open a modal showing the full recipe: title, description, category badge, prep time, cook time, total time, servings, tags as chips, ingredients list (each showing quantity + unit + item with grocery section label), and instructions (preserving newlines for numbered steps). Two action buttons: Edit (opens create/edit form modal pre-filled -- wired to E1-9) and Delete (browser confirm dialog, on confirm calls DELETE /api/recipes/{id}, closes modal, refreshes collection). Back button closes modal. Detail view fetches GET /api/recipes/{id} for complete data including ingredients.
- [x] **E1-9**: Build the recipe create/edit form modal in frontend/js/recipes.js (extending it). Modal overlay with form containing: title (text, required), description (textarea), category (dropdown: breakfast/lunch/dinner/snack/dessert, required), prep_time_minutes (number), cook_time_minutes (number), servings (number), instructions (textarea), tags (text, comma-separated). Dynamic ingredients section: container with ingredient rows, each row having quantity (number), unit (text/dropdown), item (text), grocery_section (dropdown: produce/meat/dairy/pantry/frozen/other). Add Ingredient button appends new empty row. Each row has Remove (X) button (minimum 1 row). Two modes: (a) Create via Add Recipe button -- empty fields, POST /api/recipes. (b) Edit via detail view Edit button -- pre-populated from recipe data including all ingredient rows, PUT /api/recipes/{id}. On success, modal closes and collection refreshes. Validation: title and category required; at least one ingredient with item filled.
- [x] **E1-10**: End-to-end verification of full recipe lifecycle through the UI. (1) Run pytest sprints/recipe-manager/tests/test_api.py and verify all tests pass. Fix any failures. (2) Create or update verification script at sprints/recipe-manager/.loop/verifications/run_all.py that programmatically verifies Epic 1 acceptance criteria: server starts on port 8000, GET /api/recipes returns 5 seed recipes, ingredient search works (search=oats returns results), frontend index.html served with expected DOM structure, CSS and JS files served. Script exits 0 on success, non-zero on failure. (3) Verify via browser evaluation: open localhost:8000, see 5 seed recipe cards, use filters, create a recipe, view detail, edit, delete. Confirm dark theme at 1024px and 768px.

## Verifications